


<h1>Display Data</h1>

<div>
  <form method="get" action="<%= send("search_downtime_records_path") %>">
    <div>
      <div>
        机器号：
        <%= select_tag('machine_id', options_from_collection_for_select(Machine.all, :id, :nr, @machine_id), include_blank: true) %>
      </div>
      <div>
        机器类型：
        <%= select_tag('machine_type_id', options_from_collection_for_select(MachineType.all, :id, :nr, @machine_type_id), include_blank: true) %>
      </div>
    </div>

    <div>
      <div>
        查询日期：
        <input type="text" name="time_start" class="datepicker" value="<%= @time_start %>"/>
        ~
        <input type="text" name="time_end" class="datepicker" value="<%= @time_end %>"/>
      </div>

      <div>
        <input type="submit" value="查 找" class="btn btn-primary" />
      </div>
    </div>
  </form>
</div>


<table class="table table-striped table-bordered table-hover">
  <thead>
  <tr>
    <th>NO.</th>
    <th>机器号</th>
    <th>机器类型</th>
    <th>oee</th>
    <th>availability</th>
    <th>performance</th>
    <th>停机代码</th>
  </tr>
  </thead>
  <tbody>
  <% @calc_result.each_with_index do |result, i| %>
      <tr>
        <td><%= i+1 %></td>
        <td><%= result[:machine].nr %></td>
        <td><%= result[:machine].machine_type.nr %></td>
        <td><%= result[:availability] * result[:performance]%></td>
        <td><%= result[:availability] %></td>
        <td><%= result[:performance] %></td>
      </tr>
  <% end %>
  </tbody>
</table>


<script>
    $(".datepicker").datetimepicker({
        lang: 'ch',
        format: 'Y-m-d H:i'
    });
</script>